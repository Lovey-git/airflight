!function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{X3zk:function(r,n,s){"use strict";s.r(n),s.d(n,"LoginPageModule",(function(){return y}));var i,a,o,c=s("ofXK"),u=s("3Pt+"),l=s("TEn/"),m=s("tyNb"),b=s("mrSG"),p=s("fXoL"),d=s("hD8V"),g=s("T4Fs"),h=s("LLt/"),f=s("Sy1n"),v=[{path:"",component:(i=function(){function r(t,n,s,i,a,o,c,l,m){e(this,r),this.router=t,this.fb=n,this.api=s,this.toaster=i,this.authService=a,this.alertCtrl=o,this.loadingCtrl=c,this.navCtrl=l,this.app=m,this.loginForm=this.fb.group({email:["",u.m.required],password:["",u.m.required]})}var n,s,i;return n=r,(s=[{key:"ngOnInit",value:function(){}},{key:"ionViewWillEnter",value:function(){this.authService.isLoggedin()&&("admin"==localStorage.getItem("ur")?(this.router.navigateByUrl("report"),this.app.openPage("Users")):"flight"==localStorage.getItem("current_page_type")?(this.router.navigateByUrl("home"),this.app.openPage("Booking")):(this.router.navigateByUrl("tickets"),this.app.openPage("Tickets")))}},{key:"login",value:function(){return Object(b.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r,n,s=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.loginForm.get("email").value,r=this.loginForm.get("password").value,e.next=3,this.loadingCtrl.create({cssClass:"my-custom-class",message:"Please wait..."});case 3:if(n=e.sent,""!=t){e.next=8;break}this.presentAlert("Email is required \u26a0\ufe0f"),e.next=19;break;case 8:if(""!=r){e.next=12;break}this.presentAlert("Password is required \u26a0\ufe0f"),e.next=19;break;case 12:if(!this.api.validateEmail(t)){e.next=18;break}return e.next=15,n.present();case 15:this.authService.login(t,r).subscribe((function(e){0==e.status?(n.dismiss(),localStorage.setItem("uuid",e.data[0].uuid),localStorage.setItem("ur",e.data[0].role),localStorage.setItem("username",e.data[0].surname+" "+e.data[0].name),s.app.isLoggedIn=!0,window.location.reload()):1==e.status?(n.dismiss(),s.do_activate_user(e.msg)):(n.dismiss(),s.presentAlert(e.msg))}),(function(e){n.dismiss(),s.presentAlert("Could not connect to server \ud83d\udda5\ufe0f, check your internet connection!")})),e.next=19;break;case 18:this.presentAlert("Invalid email entered \u274c");case 19:case"end":return e.stop()}}),e,this)})))}},{key:"presentAlert",value:function(e){return Object(b.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.alertCtrl.create({cssClass:"my-custom-class",header:"Air Food \u2708\ufe0f",subHeader:"Warning",message:e,buttons:["OK"]});case 2:return r=t.sent,t.next=5,r.present();case 5:case"end":return t.stop()}}),t,this)})))}},{key:"resetPass",value:function(){return Object(b.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.loginForm.get("email").value,e.next=3,this.alertCtrl.create({cssClass:"my-custom-class",header:"Reset Password!",inputs:[{name:"email",type:"text",placeholder:"Enter your Email",cssClass:"specialClass",attributes:{inputmode:"decimal",value:""}}],buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:function(){}},{text:"Ok",handler:function(e){return Object(b.a)(n,void 0,void 0,regeneratorRuntime.mark((function r(){var n,s=this;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.loadingCtrl.create({cssClass:"my-custom-class",message:"Please wait..."});case 2:if(n=r.sent,!(e.email.length<3)){r.next=7;break}this.presentAlert("Email Required"),r.next=10;break;case 7:return r.next=9,n.present();case 9:this.api.reset_password(t).subscribe((function(e){0==e.status?(n.dismiss(),s.toaster.successToast(e.msg),s.presentAlert("Password reseted check your emails for further instructions!"),console.log(e)):(n.dismiss(),s.presentAlert(e.msg))}),(function(e){n.dismiss(),s.presentAlert(e.message)}));case 10:case"end":return r.stop()}}),r,this)})))}}]});case 3:return r=e.sent,e.next=6,r.present();case 6:case"end":return e.stop()}}),e,this)})))}},{key:"do_activate_user",value:function(e){return Object(b.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r,n,s=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=this.loginForm.get("email").value,console.log(r),t.next=4,this.alertCtrl.create({cssClass:"my-custom-class",header:"Re-activate",message:e,buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:function(){}},{text:"Re-activate",handler:function(e){return Object(b.a)(s,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadingCtrl.create({cssClass:"my-custom-class",message:"Please wait..."});case 2:return t=e.sent,e.next=5,t.present();case 5:this.api.activate_user(r).subscribe((function(e){0==e.status?(t.dismiss(),n.toaster.successToast(e.msg),n.presentAlert("Re-activation in process, check your emails for further instructions!"),console.log(e)):(t.dismiss(),n.presentAlert(e.msg))}),(function(e){t.dismiss(),n.presentAlert(e.message)}));case 6:case"end":return e.stop()}}),e,this)})))}}]});case 4:return n=t.sent,t.next=7,n.present();case 7:case"end":return t.stop()}}),t,this)})))}},{key:"revert",value:function(){this.loginForm.reset()}}])&&t(n.prototype,s),i&&t(n,i),r}(),i.\u0275fac=function(e){return new(e||i)(p.Hb(m.g),p.Hb(u.a),p.Hb(d.a),p.Hb(g.a),p.Hb(h.a),p.Hb(l.b),p.Hb(l.K),p.Hb(l.N),p.Hb(f.a))},i.\u0275cmp=p.Bb({type:i,selectors:[["app-login"]],decls:30,vars:1,consts:[["fullscreen",""],[1,"login-form"],[1,"txt-center"],["name","log-in-outline",2,"font-size","55px"],["color","dark"],[3,"formGroup","ngSubmit"],["formControlName","email","type","text","required","","placeholder","Email"],["name","at-outline"],["formControlName","password","required","","placeholder","Password","type","Password"],["slot","start","name","lock-closed-outline"],["type","submit","color","primary",1,"txt-center"],["color","primary","routerLink","/register",3,"click"],["color","primary",2,"cursor","pointer","text-decoration","underline",3,"click"]],template:function(e,t){1&e&&(p.Kb(0,"ion-content",0),p.Kb(1,"ion-grid"),p.Kb(2,"div",1),p.Kb(3,"ion-col"),p.Kb(4,"div",2),p.Ib(5,"ion-icon",3),p.Ib(6,"br"),p.Kb(7,"strong"),p.gc(8,"Login"),p.Jb(),p.Ib(9,"br"),p.Kb(10,"ion-label",4),p.gc(11,"Sign Into Your Account."),p.Jb(),p.Ib(12,"br"),p.Ib(13,"br"),p.Jb(),p.Kb(14,"form",5),p.Sb("ngSubmit",(function(){return t.login()})),p.Kb(15,"ion-input",6),p.Ib(16,"ion-icon",7),p.Jb(),p.Ib(17,"br"),p.Kb(18,"ion-input",8),p.Ib(19,"ion-icon",9),p.Jb(),p.Ib(20,"br"),p.Kb(21,"ion-button",10),p.gc(22,"Login"),p.Jb(),p.Jb(),p.Kb(23,"ion-footer",2),p.Ib(24,"br"),p.Kb(25,"a",11),p.Sb("click",(function(){return t.app.openPage("Register")})),p.gc(26,"No account? Sign up here."),p.Jb(),p.Ib(27,"br"),p.Kb(28,"a",12),p.Sb("click",(function(){return t.resetPass()})),p.gc(29,"Forgot Password? Click here."),p.Jb(),p.Jb(),p.Jb(),p.Jb(),p.Jb(),p.Jb()),2&e&&(p.xb(14),p.Zb("formGroup",t.loginForm))},directives:[l.l,l.o,l.k,l.q,l.t,u.n,u.i,u.c,l.r,l.U,u.h,u.b,u.l,l.e,l.n,m.i,l.S],styles:[""]}),i)}],k=((o=function t(){e(this,t)}).\u0275mod=p.Fb({type:o}),o.\u0275inj=p.Eb({factory:function(e){return new(e||o)},imports:[[m.j.forChild(v)],m.j]}),o),y=((a=function t(){e(this,t)}).\u0275mod=p.Fb({type:a}),a.\u0275inj=p.Eb({factory:function(e){return new(e||a)},imports:[[c.b,u.d,l.I,k,u.k]]}),a)}}])}();