(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{X3zk:function(e,t,s){"use strict";s.r(t),s.d(t,"LoginPageModule",(function(){return h}));var i=s("ofXK"),r=s("3Pt+"),o=s("TEn/"),n=s("tyNb"),a=s("mrSG"),l=s("fXoL"),c=s("hD8V"),u=s("T4Fs"),d=s("LLt/"),m=s("Sy1n");const b=[{path:"",component:(()=>{class e{constructor(e,t,s,i,o,n,a,l,c){this.router=e,this.fb=t,this.api=s,this.toaster=i,this.authService=o,this.alertCtrl=n,this.loadingCtrl=a,this.navCtrl=l,this.app=c,this.loginForm=this.fb.group({email:["",r.m.required],password:["",r.m.required]})}ngOnInit(){}ionViewWillEnter(){this.authService.isLoggedin()&&("admin"==localStorage.getItem("ur")?(this.router.navigateByUrl("report"),this.app.openPage("Users")):"flight"==localStorage.getItem("current_page_type")?(this.router.navigateByUrl("home"),this.app.openPage("Booking")):(this.router.navigateByUrl("tickets"),this.app.openPage("Tickets")))}login(){return Object(a.a)(this,void 0,void 0,(function*(){let e=this.loginForm.get("email").value,t=this.loginForm.get("password").value;const s=yield this.loadingCtrl.create({cssClass:"my-custom-class",message:"Please wait..."});""==e?this.presentAlert("Email is required \u26a0\ufe0f"):""==t?this.presentAlert("Password is required \u26a0\ufe0f"):this.api.validateEmail(e)?(yield s.present(),this.authService.login(e,t).subscribe(e=>{0==e.status?(s.dismiss(),localStorage.setItem("uuid",e.data[0].uuid),localStorage.setItem("ur",e.data[0].role),localStorage.setItem("username",e.data[0].surname+" "+e.data[0].name),this.app.isLoggedIn=!0,window.location.reload()):1==e.status?(s.dismiss(),this.do_activate_user(e.msg)):(s.dismiss(),this.presentAlert(e.msg))},e=>{s.dismiss(),this.presentAlert("Could not connect to server \u{1f5a5}\ufe0f, check your internet connection!")})):this.presentAlert("Invalid email entered \u274c")}))}presentAlert(e){return Object(a.a)(this,void 0,void 0,(function*(){const t=yield this.alertCtrl.create({cssClass:"my-custom-class",header:"Air Food \u2708\ufe0f",subHeader:"Warning",message:e,buttons:["OK"]});yield t.present()}))}resetPass(){return Object(a.a)(this,void 0,void 0,(function*(){let e=this.loginForm.get("email").value;const t=yield this.alertCtrl.create({cssClass:"my-custom-class",header:"Reset Password!",inputs:[{name:"email",type:"text",placeholder:"Enter your Email",cssClass:"specialClass",attributes:{inputmode:"decimal",value:""}}],buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:()=>{}},{text:"Ok",handler:t=>Object(a.a)(this,void 0,void 0,(function*(){const s=yield this.loadingCtrl.create({cssClass:"my-custom-class",message:"Please wait..."});t.email.length<3?this.presentAlert("Email Required"):(yield s.present(),this.api.reset_password(e).subscribe(e=>{0==e.status?(s.dismiss(),this.toaster.successToast(e.msg),this.presentAlert("Password reseted check your emails for further instructions!"),console.log(e)):(s.dismiss(),this.presentAlert(e.msg))},e=>{s.dismiss(),this.presentAlert(e.message)}))}))}]});yield t.present()}))}do_activate_user(e){return Object(a.a)(this,void 0,void 0,(function*(){let t=this.loginForm.get("email").value;console.log(t);const s=yield this.alertCtrl.create({cssClass:"my-custom-class",header:"Re-activate",message:e,buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:()=>{}},{text:"Re-activate",handler:e=>Object(a.a)(this,void 0,void 0,(function*(){const e=yield this.loadingCtrl.create({cssClass:"my-custom-class",message:"Please wait..."});yield e.present(),this.api.activate_user(t).subscribe(t=>{0==t.status?(e.dismiss(),this.toaster.successToast(t.msg),this.presentAlert("Re-activation in process, check your emails for further instructions!"),console.log(t)):(e.dismiss(),this.presentAlert(t.msg))},t=>{e.dismiss(),this.presentAlert(t.message)})}))}]});yield s.present()}))}revert(){this.loginForm.reset()}}return e.\u0275fac=function(t){return new(t||e)(l.Hb(n.g),l.Hb(r.a),l.Hb(c.a),l.Hb(u.a),l.Hb(d.a),l.Hb(o.b),l.Hb(o.K),l.Hb(o.N),l.Hb(m.a))},e.\u0275cmp=l.Bb({type:e,selectors:[["app-login"]],decls:30,vars:1,consts:[["fullscreen",""],[1,"login-form"],[1,"txt-center"],["name","log-in-outline",2,"font-size","55px"],["color","dark"],[3,"formGroup","ngSubmit"],["formControlName","email","type","text","required","","placeholder","Email"],["name","at-outline"],["formControlName","password","required","","placeholder","Password","type","Password"],["slot","start","name","lock-closed-outline"],["type","submit","color","primary",1,"txt-center"],["color","primary","routerLink","/register",3,"click"],["color","primary",2,"cursor","pointer","text-decoration","underline",3,"click"]],template:function(e,t){1&e&&(l.Kb(0,"ion-content",0),l.Kb(1,"ion-grid"),l.Kb(2,"div",1),l.Kb(3,"ion-col"),l.Kb(4,"div",2),l.Ib(5,"ion-icon",3),l.Ib(6,"br"),l.Kb(7,"strong"),l.gc(8,"Login"),l.Jb(),l.Ib(9,"br"),l.Kb(10,"ion-label",4),l.gc(11,"Sign Into Your Account."),l.Jb(),l.Ib(12,"br"),l.Ib(13,"br"),l.Jb(),l.Kb(14,"form",5),l.Sb("ngSubmit",(function(){return t.login()})),l.Kb(15,"ion-input",6),l.Ib(16,"ion-icon",7),l.Jb(),l.Ib(17,"br"),l.Kb(18,"ion-input",8),l.Ib(19,"ion-icon",9),l.Jb(),l.Ib(20,"br"),l.Kb(21,"ion-button",10),l.gc(22,"Login"),l.Jb(),l.Jb(),l.Kb(23,"ion-footer",2),l.Ib(24,"br"),l.Kb(25,"a",11),l.Sb("click",(function(){return t.app.openPage("Register")})),l.gc(26,"No account? Sign up here."),l.Jb(),l.Ib(27,"br"),l.Kb(28,"a",12),l.Sb("click",(function(){return t.resetPass()})),l.gc(29,"Forgot Password? Click here."),l.Jb(),l.Jb(),l.Jb(),l.Jb(),l.Jb(),l.Jb()),2&e&&(l.xb(14),l.Zb("formGroup",t.loginForm))},directives:[o.l,o.o,o.k,o.q,o.t,r.n,r.i,r.c,o.r,o.U,r.h,r.b,r.l,o.e,o.n,n.i,o.S],styles:[""]}),e})()}];let p=(()=>{class e{}return e.\u0275mod=l.Fb({type:e}),e.\u0275inj=l.Eb({factory:function(t){return new(t||e)},imports:[[n.j.forChild(b)],n.j]}),e})(),h=(()=>{class e{}return e.\u0275mod=l.Fb({type:e}),e.\u0275inj=l.Eb({factory:function(t){return new(t||e)},imports:[[i.b,r.d,o.I,p,r.k]]}),e})()}}]);